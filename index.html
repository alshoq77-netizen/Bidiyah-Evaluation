<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Ù…Ø³ØªØ´ÙÙ‰ Ø¨Ø¯ÙŠØ© â€“ ØªÙ‚ÙŠÙŠÙ… Ø®Ø·Ø± Ø§Ù„Ø¥ØµØ§Ø¨Ø© Ø¨Ø§Ù„Ø³ÙƒØ±ÙŠ</title>

  <!-- CSS -->
  <style>
    body {
      font-family: "Tajawal", sans-serif;
      background: linear-gradient(to bottom right, #e3f2fd, #bbdefb);
      margin: 0;
      padding: 0;
      text-align: center;
      direction: rtl;
    }

    .container {
      max-width: 600px;
      margin: auto;
      padding: 20px;
    }

    .card {
      background: #fff;
      border-radius: 12px;
      padding: 25px;
      box-shadow: 0 3px 10px rgba(0,0,0,0.1);
      margin-bottom: 20px;
    }

    .btn {
      background: #0077cc;
      color: white;
      border: none;
      border-radius: 8px;
      padding: 10px 18px;
      margin: 5px;
      font-size: 16px;
      cursor: pointer;
      transition: 0.3s;
    }
    .btn:hover { background: #005fa3; }

    .btn.ghost {
      background: #e0e0e0;
      color: #333;
    }

    .btn.primary {
      background: #0077cc;
      color: white;
    }

    label {
      display: block;
      margin-bottom: 12px;
      text-align: right;
    }

    input, select {
      width: 100%;
      padding: 8px;
      margin-top: 6px;
      border: 1px solid #ccc;
      border-radius: 6px;
    }

    .options {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
    }

    .result-box {
      background: #f1f8e9;
      border: 1px solid #c5e1a5;
      padding: 20px;
      border-radius: 8px;
    }

    .site-footer {
      padding: 15px;
      font-size: 14px;
      color: #555;
    }
  </style>

  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>

<body>

  <div class="container">

    <!-- Ø§Ù„Ù…Ù‚Ø¯Ù…Ø© -->
    <section id="intro" class="card">
      <h2>Ù…Ø±Ø­Ø¨Ù‹Ø§ Ø¨Ùƒ ÙÙŠ Ø£Ø¯Ø§Ø© Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</h2>
      <p>
        Ù‡Ø°Ù‡ Ø§Ù„Ø£Ø¯Ø§Ø© ØªÙ‚Ø¯Ù‘Ù… ØªÙ‚ÙŠÙŠÙ…Ù‹Ø§ ØªÙˆØ¹ÙˆÙŠÙ‹Ø§ Ù„Ø®Ø·Ø± Ø§Ù„Ø¥ØµØ§Ø¨Ø© Ø¨Ù…Ø±Ø¶ Ø§Ù„Ø³ÙƒØ±ÙŠ Ù…Ù† Ø§Ù„Ù†ÙˆØ¹ Ø§Ù„Ø«Ø§Ù†ÙŠ.
      </p>
      <button id="startBtn" class="btn primary">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¢Ù† â©</button>
    </section>

    <!-- Ø§Ù„Ø§Ø³ØªØ¨ÙŠØ§Ù† -->
    <section id="survey" class="card" hidden>

      <!-- Step 1 -->
      <div class="step" data-step="1">
        <h3>Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</h3>

        <label>Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù…Ø¯Ù†ÙŠ
          <input id="civilNumber" type="text" maxlength="20">
        </label>

        <label>Ø§Ù„Ø¹Ù…Ø±
          <input id="age" type="number" min="1" max="120">
        </label>

        <label>Ø§Ù„Ø¬Ù†Ø³
          <select id="gender">
            <option value="female">Ø£Ù†Ø«Ù‰</option>
            <option value="male">Ø°ÙƒØ±</option>
          </select>
        </label>
      </div>

      <!-- Step 2 -->
      <div class="step" data-step="2" hidden>
        <h3>Ù‡Ù„ Ù„Ø¯ÙŠÙƒ Ù‚Ø±ÙŠØ¨ Ù…ØµØ§Ø¨ Ø¨Ø§Ù„Ø³ÙƒØ±ÙŠØŸ</h3>
        <div class="options">
          <button class="btn option" data-value="yes">Ù†Ø¹Ù…</button>
          <button class="btn option" data-value="no">Ù„Ø§</button>
          <button class="btn option" data-value="dontknow">Ù„Ø§ Ø£Ø¹Ø±Ù</button>
        </div>
      </div>

      <!-- Step 3 -->
      <div class="step" data-step="3" hidden>
        <h3>Ù‡Ù„ ØªÙ… ØªØ´Ø®ÙŠØµÙƒ Ø¨Ø§Ø±ØªÙØ§Ø¹ Ø¶ØºØ· Ø§Ù„Ø¯Ù…ØŸ</h3>
        <div class="options">
          <button class="btn option" data-value="yes">Ù†Ø¹Ù…</button>
          <button class="btn option" data-value="no">Ù„Ø§</button>
        </div>
      </div>

      <!-- Step 4 BMI -->
      <div class="step" data-step="4" hidden>
        <h3>Ù‚ÙŠØ§Ø³ ÙƒØªÙ„Ø© Ø§Ù„Ø¬Ø³Ù… (BMI)</h3>

        <label>Ø§Ù„Ø·ÙˆÙ„ (Ø³Ù…)
          <input id="height" type="number" min="30" max="300">
        </label>

        <label>Ø§Ù„ÙˆØ²Ù† (ÙƒØ¬Ù…)
          <input id="weight" type="number" min="10" max="500">
        </label>

        <p>Ù…Ø¤Ø´Ø± ÙƒØªÙ„Ø© Ø§Ù„Ø¬Ø³Ù…: <strong id="bmiValue">-</strong></p>
        <p>Ø§Ù„ØªØµÙ†ÙŠÙ: <strong id="bmiCategory">-</strong></p>
      </div>

      <!-- Step 5 -->
      <div class="step" data-step="5" hidden>
        <h3>Ù‡Ù„ ØªØªÙ†Ø§ÙˆÙ„ Ø§Ù„Ø®Ø¶Ø§Ø± ÙˆØ§Ù„ÙÙˆØ§ÙƒÙ‡ ÙŠÙˆÙ…ÙŠÙ‹Ø§ ØªÙ‚Ø±ÙŠØ¨Ù‹Ø§ØŸ</h3>
        <div class="options">
          <button class="btn option" data-value="daily">ÙŠÙˆÙ…ÙŠÙ‹Ø§</button>
          <button class="btn option" data-value="sometimes">Ø£Ø­ÙŠØ§Ù†Ù‹Ø§</button>
          <button class="btn option" data-value="rarely">Ù†Ø§Ø¯Ø±Ù‹Ø§</button>
        </div>
      </div>

      <!-- Step 6 -->
      <div class="step" data-step="6" hidden>
        <h3>Ù…Ø­ÙŠØ· Ø§Ù„Ø®ØµØ±</h3>
        <label>
          <input id="waist" type="number" placeholder="Ø£Ø¯Ø®Ù„ Ù…Ø­ÙŠØ· Ø§Ù„Ø®ØµØ± Ø¨Ø§Ù„Ø³Ù…">
        </label>
      </div>

      <!-- Step 7 -->
      <div class="step" data-step="7" hidden>
        <h3>Ø§Ù„Ù†Ø´Ø§Ø· Ø§Ù„Ø¨Ø¯Ù†ÙŠ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠ</h3>
        <div class="options">
          <button class="btn option" data-value="0">0 Ø£ÙŠØ§Ù…</button>
          <button class="btn option" data-value="1-2">1â€“2 Ø£ÙŠØ§Ù…</button>
          <button class="btn option" data-value="3+">3 Ø£ÙŠØ§Ù… Ø£Ùˆ Ø£ÙƒØ«Ø±</button>
        </div>
      </div>

      <!-- Step 8 -->
      <div class="step" data-step="8" hidden>
        <h3>Ù†ØªÙŠØ¬ØªÙƒ Ø§Ù„ØµØ­ÙŠØ©</h3>
        <div id="finalResult" class="result-box"></div>

        <button id="submitBtn" class="btn primary">ğŸ“¤ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
        <button id="restartBtn" class="btn">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</button>
      </div>

      <!-- ØªÙ†Ù‚Ù„ -->
      <div>
        <button id="prevBtn" class="btn ghost" hidden>Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
        <button id="nextBtn" class="btn primary" hidden>Ø§Ù„ØªØ§Ù„ÙŠ</button>
      </div>

    </section>
  </div>

  <footer class="site-footer">
    <p>Â© Ù…Ø³ØªØ´ÙÙ‰ Ø¨Ø¯ÙŠØ© 2025</p>
  </footer>

  <!-- JavaScript -->
  <script>
    // =========================
    //  Ø§Ø³ØªØ¨ÙŠØ§Ù† Ø§Ù„Ø³ÙƒØ±ÙŠ - Ù…Ø³ØªØ´ÙÙ‰ Ø¨Ø¯ÙŠØ©
    // =========================

    const startBtn = document.getElementById("startBtn");
    const survey = document.getElementById("survey");
    const steps = document.querySelectorAll(".step");
    const nextBtn = document.getElementById("nextBtn");
    const prevBtn = document.getElementById("prevBtn");
    const submitBtn = document.getElementById("submitBtn");
    const restartBtn = document.getElementById("restartBtn");
    const finalResult = document.getElementById("finalResult");

    const GOOGLE_SCRIPT_URL = "https://sheetdb.io/api/v1/1ut4e13p8dyk6";

    let userData = {};
    let currentStep = 1;

    startBtn.addEventListener("click", () => {
      document.getElementById("intro").hidden = true;
      survey.hidden = false;
      showStep(1);
    });

    function showStep(step) {
      steps.forEach(s => s.hidden = true);
      const el = document.querySelector(\`.step[data-step="\${step}"]\`);
      if (el) el.hidden = false;

      prevBtn.hidden = step === 1;
      nextBtn.hidden = step === steps.length;
    }

    nextBtn.addEventListener("click", () => {
      saveCurrentStepData();
      currentStep++;
      showStep(currentStep);
    });

    prevBtn.addEventListener("click", () => {
      currentStep--;
      ifprevBtn.addEventListener("click", () => {
      currentStep--;
      if (currentStep < 1) currentStep = 1;
      showStep(currentStep);
    });

    // Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±
    document.querySelectorAll(".btn.option").forEach(btn => {
      btn.addEventListener("click", e => {
        const step = e.target.closest(".step");
        const stepNum = step.dataset.step;
        userData[`step${stepNum}`] = e.target.dataset.value;
        currentStep++;
        showStep(currentStep);
      });
    });

    // Ø­ÙØ¸ Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª
    function saveCurrentStepData() {
      const step = document.querySelector(`.step[data-step="${currentStep}"]`);
      if (!step) return;

      step.querySelectorAll("input, select").forEach(el => {
        if (el.id) userData[el.id] = el.value;
      });
    }

    // =========================
    // BMI
    // =========================
    const heightInput = document.getElementById("height");
    const weightInput = document.getElementById("weight");
    const bmiValue = document.getElementById("bmiValue");
    const bmiCategory = document.getElementById("bmiCategory");

    function calculateBMI() {
      const h = parseFloat(heightInput.value);
      const w = parseFloat(weightInput.value);

      if (h && w) {
        const bmi = (w / ((h / 100) ** 2)).toFixed(1);
        bmiValue.textContent = bmi;

        let category = "";
        if (bmi < 18.5) category = "Ù†Ø­Ø§ÙØ©";
        else if (bmi < 25) category = "Ø·Ø¨ÙŠØ¹ÙŠ";
        else if (bmi < 30) category = "Ø²ÙŠØ§Ø¯Ø© ÙˆØ²Ù†";
        else category = "Ø³Ù…Ù†Ø©";

        bmiCategory.textContent = category;
        userData.BMI = bmi;
        userData.BMI_Category = category;
      }
    }

    heightInput?.addEventListener("input", calculateBMI);
    weightInput?.addEventListener("input", calculateBMI);

    // =========================
    // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªÙŠØ¬Ø©
    // =========================
    function showFinalResult() {
      let score = 0;

      if (userData.step2 === "yes") score += 2;
      if (userData.step3 === "yes") score += 2;
      if (userData.BMI && parseFloat(userData.BMI) > 30) score += 3;
      if (userData.step5 === "rarely") score += 2;
      if (userData.step7 === "0") score += 2;

      let level = "Ù…Ù†Ø®ÙØ¶";
      if (score >= 3 && score < 6) level = "Ù…ØªÙˆØ³Ø·";
      if (score >= 6) level = "Ù…Ø±ØªÙØ¹";

      finalResult.innerHTML = `
        <p><strong>Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø®Ø·ÙˆØ±Ø©:</strong> ${level}</p>
        <p>Ø§Ù„Ù†Ù‚Ø§Ø·: ${score}</p>
      `;

      userData.Risk_Score = score;
      userData.Risk_Level = level;

      if (level === "Ù…ØªÙˆØ³Ø·" || level === "Ù…Ø±ØªÙØ¹") {
        setTimeout(() => {
          Swal.fire({
            title: "ØªÙ†Ø¨ÙŠÙ‡ Ù…Ù‡Ù…",
            html: `
              <p style="font-size:18px; line-height:1.7;">
                Ù…Ø´Ø§Ø±ÙƒØªÙƒ Ø¯Ù„ÙŠÙ„ ÙˆØ¹ÙŠÙƒ ÙˆØ§Ù‡ØªÙ…Ø§Ù…Ùƒ... ÙˆÙ„Ø£Ù† ØµØ­ØªÙƒ ØªØ³ØªØ­Ù‚ Ø§Ù„Ø£ÙØ¶Ù„ ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø¹ÙŠØ§Ø¯Ø© Ø§Ù„ØªØ«Ù‚ÙŠÙ Ø§Ù„ØµØ­ÙŠ:<br>
                <a href="https://wa.me/96825584055"
                   target="_blank"
                   style="color:#0a7aff; font-size:22px; font-weight:bold;">
                  25584055
                </a>
              </p>
            `,
            icon: "warning",
            confirmButtonText: "Ù…ØªØ§Ø¨Ø¹Ø©"
          });
        }, 300);
      }
    }

    // =========================
    // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    // =========================
    submitBtn.addEventListener("click", async () => {
      saveCurrentStepData();
      userData.civilNumber = document.getElementById("civilNumber").value;

      showFinalResult();

      try {
        await fetch(GOOGLE_SCRIPT_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ sheet1: userData })
        });
      } catch (err) {
        console.error(err);
      }
    });

    // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙ‚ÙŠÙŠÙ…
    restartBtn.addEventListener("click", () => {
      userData = {};
      currentStep = 1;
      showStep(1);
    });
  </script>
</body>
</html>
